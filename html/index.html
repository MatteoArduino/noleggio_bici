<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- inclusione di bootstrap 5 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />

    <title>login</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function() {

          // Inizializza la mappa centrata sulla scuola
          var map = L.map('map').setView([45.6872271, 9.1771582], 13);

          L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
              attribution: 'Â© OpenStreetMap contributors'
          }).addTo(map);

          $.ajax({
              type: "GET",
              url: "../php/getStazioni.php",
              success: function(response){
                  for(let i = 0; i < response.length; i++){
                      addMarker(map, response[i]);
                  }  
              },
              error: function(xhr, status, error) {
                  console.error("Errore AJAX: ", status, error);
              }
          });
      });

      function addMarker(map, response){
          var marker = L.marker([response["lon"], response["lat"]]).addTo(map);
          marker.bindPopup("ID: " + response["id"]);
      }
  </script>

  </head>
  <body>
    <!-- inizio intestazione -->
    <div class="bg-light p-4">
      <ul class="nav justify-content-end">
        <li class="nav-item">
          <a class="nav-link" href="registra.html"><b>Registrati</b></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="login.html"><b>Login</b></a>
        </li>
      </ul>
    </div>
    <!-- fine intestazione -->

    <!-- mappa -->
    <div id="map" style="height: 600px"></div>

    <!-- inclusione delle dipendenze di bootstrap -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
